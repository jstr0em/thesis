\section{Meshing}\label{sec:meshing}

A mesh is a collection of small discrete elements that in combination form a larger geometry or domain.
Meshing is the process of generating a mesh.
Meshing is perhaps one of the most important and challenging aspects of solving a FEM model and a well-constructed mesh is necessary for accurate and reliable results.\par

In theory, an infinitely fine mesh will give the analytical solution to a PDE but obviously the computational costs would be infinite then as well; one must always balance the accuracy of the solution and computational resources.
This balancing act is somewhat of an art and there are no easily defined rights or wrongs.
However, there are general guidelines that are useful to keep in mind while meshing.
But before we get into those it is worth to spend some more time on what a mesh is.\par

The most fundamental unit of the mesh is the element(s) that comprise the mesh.
There are many different types of elements that can be used for meshing and choosing which ones to use depend primarily on the spatial dimensionality of the model, the particularities of the geometry, and the physics that we wish to model.
Obviously different element types are by necessity needed to model a 2D vs. 3D geometry; you cannot mesh a 3D geometry with 2D squares.
This distinction is not very interesting and any lesson learnt about meshing in one of these dimensions is easily generalizable to the other.
Thus, we will exclusively discuss the meshing of 3D elements.\par

There are primarily four types of 3D mesh elements available - the tetrahedral, cuboid, prism, and pyramid - see Figure \ref{fig:3d_elements}.
These can be combined in various ways to represent any 3D geometry.
The most general out of these is the tetrahedral and will approximate any geometry well.
It is not always the most effective choice for meshing a geometry and another element type may be better suited.
This is easiest illustrated with an example.\par

% TODO: Add figure
\begin{figure}
  %\includegraphics{}
  \caption{Four common mesh elements used to mesh three-dimensional geometries.}
  \label{fig:3d_elements}
\end{figure}

Imagine that you are trying to simulate the laminar flow of some fluid through a pipe and been clever enough to realize that by virtue of symmetry only a wedge of the pipe is necessary to be explicitly modeled.
We also realize that the flow through the pipe is going to primarily have a gradient in the direction of the flow.
In this scenario, it might be beneficial to use prism elements rather than tetrahedrals.
Furthermore we could also primarily make the mesh fine in the flow direction while keeping it relatively coarse in other directions.
This would allow us to achieve a solution of high accuracy while still keeping the number of elements relatively small.\par

This is of course a relatively simple example of how an alternative mesh element may be used.
For complicated geometries may use all kinds of element shapes in various parts of its domain.
These type of multi-element meshes can give significant computational saving but at the expense of often requiring significant user input to be generated.
Sticking to one type of elements is often simpler as these can quickly and easily mesh geometries.\par

Once we have chosen which element(s) to use to mesh our geometry we can move on to creating the mesh.
This is done by passing on a series of instructions to a meshing algorithm.
Here the user could, for instance, specify the maximum and minimum element sizes, max element growth rate, how finely small features or curves (typically quite difficult to mesh) should be meshed.
These instructions can be specific to various parts of the model, e.g. much finer meshing resolution can be specified for an area of interest and vice versa.
There are also a variety of specialty mesh features such as a mesh boundary layer available: adding finely spaced mesh layers along a boundary.
How to use all of these tools effectively to mesh a geometry is why meshing can be one of the most challenging aspects of FEM modeling.\par

\subsection{Mesh Study}\label{sec:mesh_study}

How does one evaluate that a mesh is sufficiently fine?
While there are various metrics that can be useful to determine the quality of a mesh, the most important one is to perform a mesh study.
The purpose of a mesh study is to determine the convergence of some property as you increase the fineness of the mesh.\par

To perform a mesh study you must first define an appropriate metric for the particular problem you want to solve.
In vapor intrusion a good choice for this might be the indoor air contaminant concentration, as predicting human exposure is the ultimate goal of VI modeling.
The next step is to determine which degree of accuracy is desired (convergence criteria).
Create a mesh with the fewest, reasonable number of mesh elements, solve the model, and analyze the results.
Iteratively:
\begin{enumerate}
  \item Remesh the model with a finer mesh.
  \item Solve and analyze the results.
  \item Plot the result vs. mesh number/ID.
  \item Repeat until convergence is met.
\end{enumerate}
In step three we plot the result vs. i:th mesh, which is the simplest approach, but one could here instead use a variety of mesh metrics instead.
The benefit of this would be that you could which improvement of which specific aspect of the mesh results in a better result, which may make meshing easier.
But it can be difficult and usually it is sufficient to simply use your experience and expertise as a guide to determine that your mesh is improved where appropriate.\par

% TODO: Add figure
\begin{figure}[htb!]
  %\includegraphics{}
  \caption{Example result of a mesh study.}
  \label{fig:mesh_study}
\end{figure}

\subsection{Meshing The VI Model}

Now that we know a little about meshing in general, we can move on and mesh our VI model geometry.
The first choice we need to make is which type of element to use, and in order to do that we need to think about the gradients of the dependent variables.\par

In Richards' equation, the relevant gradient is the capillary pressure gradient, which will go from the water table to the surface, i.e. relatively straight.
The Darcy's Law pressure gradient will however not be so straight as we expect a vapor flow from the surface to the building through the foundation crack, forming some sort of arcing streamline; the pressure gradient will be aligned to this streamline.
The concentration gradient in the mass transport will likewise have an irregular direction.\par

Since many of these gradients intersect and go in different directions from each other it makes sense to use tetrahedral elements to mesh the geometry.
The aspect ratio between the nodes of each tetrahedra are relatively similar which allows gradients from different directions to be better resolved.
Tetrahedral elements are also convenient to use for their simplicity.\par

Properly meshing our geometry can be a challenge due to the great range of geometric scale.
The house and soil domains are on the order of meters while the foundation crack, which is the most important part of the model, is only a centimeter wide.
Care must be taken to make sure that foundation crack is finely meshed with small elements (for accurate results) while using larger for the rest of the geometry (to save computation time), i.e. the mesh element size must vary.\par

% TODO: Make sure that my statement regarding "most" mesh algorithms is true
Precisely how this is achieved vary depending on the mesh algorithm that you use.
However, most should be able to automatically mesh the geometry reasonably well by specifying the maximum and minimum mesh sizes, the maximum element growth rate, how finely


\begin{figure}[htb!]
  %\includegraphics{}
  \caption{Our meshed geometry.}
  \label{fig:meshed_geometry}
\end{figure}
